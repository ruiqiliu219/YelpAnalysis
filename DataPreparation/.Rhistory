residualPlot(m1)
par(mfrow=c(1,1))
residualPlot(m1)
residualPlot(m2)
mmps(m2)
plot(m2)
infIndexPlot(m1)
infIndexPlot(m2)
mNone = lm(O2UP ~ 1,dwaste)
mAll = lm(O2UP ~ BOD + TKN + TS + TVS + COD,dwaste)
#Backward Elimination using AIC
step(mAll,scope = list(lower = ~1,upper = ~1+BOD + TKN + TS + TVS + COD),direction = "backward", data = dwaste,k = 2)
step(mNone,scope = list(lower = ~1,upper = ~1+BOD + TKN + TS + TVS + COD),direction = "forward", data = dwaste,k = 2)
a = lm(O2UP ~ COD + TS,dwaste)
anova(m1,a)
a = lm(O2UP ~ TS,dwaste)
b = lm(O2UP ~ TS + COD,dwaste)
anova(a,b)
summary(a)
summary(b)
summary(m2)
mNone = lm(log(O2UP) ~ 1,dwaste)
mAll = lm(log(O2UP) ~ BOD + TKN + TS + TVS + COD,dwaste)
step(mAll,scope = list(lower = ~1,upper = ~1+BOD + TKN + TS + TVS + COD),direction = "backward", data = dwaste,k = 2)
#Forward Selection using AIC
step(mNone,scope = list(lower = ~1,upper = ~1+BOD + TKN + TS + TVS + COD),direction = "forward", data = dwaste,k = 2)
m1 = lm(log(O2UP) ~ COD + TS,dwaste)
#Residuals plot
par(mfrow=c(1,1))
residualPlot(m1)
#check potential outlier/influential cases
infIndexPlot(m1)
m2 = update(m1,subset = -1)
residualPlot(m2)
mmps(m2) #marginal model plot become much more reseaonalbe after deleting case 1.
mmps(m1)
mmps(m2) #marginal model plot become much more reseaonalbe after deleting case 1.
summay(powerTransform(cbind(BOD,TKN,TS,TVS,COD)~1,data=dwaste))
summary(powerTransform(cbind(BOD,TKN,TS,TVS,COD)~1,data=dwaste))
summary(powerTransform(cbind(BOD,TKN,TS,TVS,COD)~1,data=dwaste),subset = -17)
summary(m2)
anova(m2)
summary(m2)
m3 = update(m2,.~.+factor(Day))
anova(m3)
summary(m3)
str(dwaste)
dwaste$Day = factor(dwaste$Day)
str(dwaste)
summary(m2)
m1 = lm(log(O2UP) ~ COD + TS,dwaste)
#Residuals plot
residualPlot(m1)
summary(m1)
residualPlot(m1)
plot(m1)
plot(m2)
mmps(m1)
anova(m2)
m2 = update(m1,subset = -1)
```
summary(m2)
m3 = update(m2,.~-COD)
anova(m2,m3)
anova(m3,m2)
summary(m3)
m2 = update(m1,subset = -1)
```
The final model is log(O2UP) ~ COD + TS
m3 = update(m2,.~. -COD)
summary(m2)
summary(m3)
anova(m2,m3)
anova(m3,m2)
anova(m3,m2)
anova(m2)
mmpl(m3)
mmps(m3)
summary(m2)
m3 = update(m2,.~. -COD)
anova(m3,m2)
residualPlot(m3)
plot(m3)
residualPlot(m3) #residual plot looks good
mmps(m3)
?qnorm
pnorm(4.95,mean = 5, sd = 0.02, lower.tail = T)
up = pnorm(5.05, mean = 5, sd = 0.02, lower.tail = F)
low = pnorm(4.95,mean = 5, sd = 0.02, lower.tail = T)
lower = pnorm(4.95,mean = 5, sd = 0.02, lower.tail = T)
upper = pnorm(5.05, mean = 5, sd = 0.02, lower.tail = F)
p.conform = 1 - lower - upper
p.conform
qnorm(0.0228, mean = 0, sd = 1, lower.tail = T)
$\frac{32 - \mu}{4}$ = -1.999077
-1.999077 * 4
32 - -7.996308
pnorm(32,40,4)
pnorm(32,39.99631,4)
qnorm(0.005, mean = 5000, sd = 50, lower.tail = T)
100 * 0.01 * (1-0.01)
0.99
1% x (1-1%) /100
1% x 0.99 /100
0.01 x 0.99 /100
0.01 * 0.99 /100
sqrt(9.9e-05)
?binomial
P($\hat{p}$ - 0.01 >  0.009949874) = P(x/100 > 0.019949874) = P(x>1.9949874),where x~ Binomial(100,0.01) = P(x>= 2) = 1- P(x=0) - P(x=1) = 1 -$\binom {100}{0} x 0.01^0 x 0.99^100$ -$\binom {100}{1} x 0.01^1 x 0.99^99$ =
pbinom(2,100,0.01,lower.tail=F)
C <- sqrt(qchisq(0.95, n-1) / (n-1))
n = 16
C <- sqrt(qchisq(0.95, n-1) / (n-1))
sig = seq(1,2,0.05)
beta = pchisq((n-1)*(C/sig)^2, n-1)
plot(beta ~ sig,main = "OC curve",ylim = c(0,1))
mu    <- seq(125, 128, 0.1)
sigma <- 2
n     <- 8
OC    <- pnorm(1.645 - (mu-125)*sqrt(n)/sigma)
plot(OC~mu, main="OC curve for normal mean",ylab="OC",pch = 20)
126837458671519241991310240217569075601016363887697968335052376ï¼365^50
126837458671519241991310240217569075601016363887697968335052376/365^50
1-9.741017e-67
comb = function(n, x) {
return(factorial(n) / (factorial(x) * factorial(n-x)))
}
a = comb(365,50)
a = 126837458671519241991310240217569075601016363887697968335052376
1 - a / (365^50)
3857646289504054928312465917716524020048954031096063288039587978894265754061268290801404629455937423596203395776512000000000000/365^2
3857646289504054928312465917716524020048954031096063288039587978894265754061268290801404629455937423596203395776512000000000000/365^50
1- 0.02962642
1 - (365!/50!) /365^50
2!
1 - (factoial(365)/factorial(315)) /365^50
1 - (factorial(365)/factorial(315)) /365^50
3857646289504054928312465917716524020048954031096063288039587978894265754061268290801404629455937423596203395776512000000000000/365^50
1 - 3857646289504054928312465917716524020048954031096063288039587978894265754061268290801404629455937423596203395776512000000000000/365^50
42 + 12 + 60 + 24
sqrt((12*12.32 + 10*17.22+ 12 * (12.3-17.2)^2 + 10(17.2-12.3))/(22))
sqrt((12*12.32 + 10*17.22+ 12 * (12.3-17.2)^2 + 10 * (17.2-12.3))/(22))
sqrt((12*12.32 + 10*17.22+ 12 * (12.3-17.2)^2 + 10 * (17.2-12.3)^2)/(22))
sqrt((12.32^2 + 17.2^2)/2)
getwd()
piston = read.csv("/Users/ruiqiliu/Desktop/Piston_data.csv)
piston = read.csv("/Users/ruiqiliu/Desktop/Piston_data.csv")
piston = read.csv("/Users/ruiqiliu/Desktop/Piston_data.csv")
piston
Xbar = c(74.0102,74.0006,74.008,74.003,74.0034,73.9956,74,73.9968,74.0042,73.998,73.9942,74.0014,73.9984,73.9902,74.006,73.9966,74.0008,74.0074,73.9982,74.0092,73.9998,74.0016,74.0024,74.0052,73.9982)
R = c(0.038,0.019,0.036,0.022,0.026,0.024,0.012,0.03,0.014,0.017,0.008,0.011,0.029,0.039,0.016,0.021,0.026,0.018,0.021,0.02,0.033,0.019,0.025,0.022,0.035)
S = c(0.0147716,0.0075033,0.0147479,0.009083,0.0122188,0.0087063,0.0055227,0.0122556,0.0055408,0.0062849,0.0028636,0.004219,0.0104547,0.0153036,0.0073144,0.0077974,0.0105688,0.0069857,0.0084676,0.0079812,0.0121532,0.0074364,0.011929,0.0087006,0.0161771)
length(R)
newXbar = c(78.2,77.4,80.8,85.6,82.7,75.9,82.9,77.8,74.9,81.9,73.4,81.3,81.7,73.3,83.5)
newR - c(12.6,15.7,6.8,17.5,22.5,21.3,27.9,14.6,11,14,24.9,10.9,27.6,19.9,22.2)
plot(newxbar, main = "Xbar chart", type = "b",ylim = c(72,86),ylab = "Mean",xlab = "Rational Group")
abline(h = LCLx,lty = 2)
abline(h = UCLx, lty = 2)
abline(h = xBarBar)
A2 = 0.577
D4 = 2.114
D3 = 0
xBar = c(79.1,80.2,80.4,77.5,80.3,82.8,77.3,81.1,81.4,75.7,78.4,79.4,80.9,77.1,79.1,79.7,79.2,81.1,80.8,79.1)
R = c(7.3,17.6,10.4,8.4,5.2,14.5,7.4,11.4,9.9,10.9,7.7,8,3.6,4.3,13.8,2,6.6,7.6,6.6,11.4)
xBarBar = mean(xBar)
RBar = mean(R)
UCLx = xBarBar + A2 * RBar
LCLx = xBarBar - A2 * RBar
plot(xBar, main = "Xbar chart", type = "b",ylim = c(72,86),ylab = "Mean",xlab = "Rational Group")
abline(h = LCLx,lty = 2)
abline(h = UCLx, lty = 2)
abline(h = xBarBar)
UCLR = D4 * RBar
LCLR = D3 * RBar
plot(R,ylab="Range", xlab="Rational group",type = "b",ylim = c(0,20),main="R chart")
abline(h = UCLR, lty=2)
abline(h = LCLR, lty=2)
abline(h = RBar)
newXbar = c(78.2,77.4,80.8,85.6,82.7,75.9,82.9,77.8,74.9,81.9,73.4,81.3,81.7,73.3,83.5)
newR - c(12.6,15.7,6.8,17.5,22.5,21.3,27.9,14.6,11,14,24.9,10.9,27.6,19.9,22.2)
plot(newxbar, main = "Xbar chart", type = "b",ylim = c(72,86),ylab = "Mean",xlab = "Rational Group")
abline(h = LCLx,lty = 2)
abline(h = UCLx, lty = 2)
abline(h = xBarBar)
plot(newR,ylab="Range", xlab="Rational group",type = "b",ylim = c(0,20),main="R chart")
abline(h = UCLR, lty=2)
abline(h = LCLR, lty=2)
abline(h = RBar)
newXbar = c(78.2,77.4,80.8,85.6,82.7,75.9,82.9,77.8,74.9,81.9,73.4,81.3,81.7,73.3,83.5)
newR - c(12.6,15.7,6.8,17.5,22.5,21.3,27.9,14.6,11,14,24.9,10.9,27.6,19.9,22.2)
plot(newxbar, main = "Xbar chart", type = "b",ylim = c(72,86),ylab = "Mean",xlab = "Rational Group")
plot(newxbar, main = "Xbar chart", type = "b",ylim = c(72,86),ylab = "Mean",xlab = "Rational Group")
plot(newXbar, main = "Xbar chart", type = "b",ylim = c(72,86),ylab = "Mean",xlab = "Rational Group")
abline(h = LCLx,lty = 2)
abline(h = UCLx, lty = 2)
abline(h = xBarBar)
plot(newR,ylab="Range", xlab="Rational group",type = "b",ylim = c(0,20),main="R chart")
abline(h = UCLR, lty=2)
abline(h = LCLR, lty=2)
abline(h = RBar)
newR - c(12.6,15.7,6.8,17.5,22.5,21.3,27.9,14.6,11,14,24.9,10.9,27.6,19.9,22.2)
plot(newR,ylab="Range", xlab="Rational group",type = "b",ylim = c(0,20),main="R chart")
newR = c(12.6,15.7,6.8,17.5,22.5,21.3,27.9,14.6,11,14,24.9,10.9,27.6,19.9,22.2)
plot(newR,ylab="Range", xlab="Rational group",type = "b",ylim = c(0,20),main="R chart")
abline(h = UCLR, lty=2)
abline(h = LCLR, lty=2)
abline(h = RBar)
plot(newR,ylab="Range", xlab="Rational group",type = "b",ylim = c(0,30),main="R chart")
abline(h = UCLR, lty=2)
abline(h = LCLR, lty=2)
abline(h = RBar)
20 + 0.577 * 4,56
20 + 0.577 * 4.56
20 - 0.577 * 4.56
UCLR = D4 * 4.56
UCLR
A2
A3
A2/1.427 * 4.56
4.56/5
dat_6_10 <- read.csv(â€œhttp://stat.umn.edu/hawkins/5031/Exercise_6_10.csvâ€)
dat_6_10 = read.csv(â€œhttp://stat.umn.edu/hawkins/5031/Exercise_6_10.csvâ€)
dat_6_10 = read.csv("http://stat.umn.edu/hawkins/5031/Exercise_6_10.csv")
dat_6_10
mean(dat_6_10$R) / d2_3
mean(dat_6_10$R) / d2_3
d2_3 = 1.693
c4_3 = 0.8862
D4_3 = 2.574
B4_3 = 2.568
dat_6_10 = read.csv("http://stat.umn.edu/hawkins/5031/Exercise_6_10.csv")
#sigma estimated by Rbar
mean(dat_6_10$R) / d2_3
d2_3 = 1.693
mean(dat_6_10$R) / d2_3
# sigma estimated by Sbar
sigmahat = mean(dat_6_10$S) / c4_3
d2_3 = 1.693
c4_3 = 0.8862
D4_3 = 2.574
B4_3 = 2.568
dat_6_10 = read.csv("http://stat.umn.edu/hawkins/5031/Exercise_6_10.csv")
mean(dat_6_10$R) / d2_3
sigmahat = mean(dat_6_10$S) / c4_3
sigmahat = mean(dat_6_10$S) / c4_3
sigmahat
#Xbar chart
CL_x = mean(dat_6_10$Xbar) UCL_x = CL_x + 3 * sigmahat/sqrt(3) LCL_x = CL_x ­ 3 * sigmahat/sqrt(3) # R chart
CL_x = mean(dat_6_10$Xbar)
UCL_x = CL_x + 3 * sigmahat/sqrt(3)
LCL_x = CL_x ­ 3 * sigmahat/sqrt(3)
UCL_x = CL_x + 3 * sigmahat/sqrt(3)
LCL_x = CL_x - 3 * sigmahat/sqrt(3)
CL_R = mean(dat_6_10$R)
UCL_R = D4_3 * CL_R
CL_S = mean(dat_6_10$S)
UCL_R = B4_3 * CL_S
plot(dat_6_10$Xbar, main = "Xbar chart", type = "b",ylab = "Mean",xlab = "Rational Group")
UCL_x = CL_x + 3 * sigmahat/sqrt(3)
LCL_x = CL_x - 3 * sigmahat/sqrt(3)
UCL_x
plot(dat_6_10$Xbar, main = "Xbar chart", type = "b",ylim = c(6,6.5)ylab = "Mean",xlab = "Rational Group")
plot(dat_6_10$Xbar, main = "Xbar chart", type = "b",ylim = c(6,6.5),ylab = "Mean",xlab = "Rational Group")
plot(dat_6_10$Xbar, main = "Xbar chart", type = "b",ylim = c(6.1,6.4),ylab = "Mean",xlab = "Rational Group")
plot(dat_6_10$Xbar, main = "Xbar chart", type = "b",ylim = c(6.15,6.4),ylab = "Mean",xlab = "Rational Group")
abline(h = LCL_x,lty = 2)
abline(h = UCL_x, lty = 2)
abline(h = CL_x)
CL_R
UCL_R
CL_R = mean(dat_6_10$R)
UCL_R = D4_3 * CL_R
plot(dat_6_10$R, main = "Xbar chart", type = "b",ylim = c(0,0.13),ylab = "Mean",xlab = "Rational Group")
plot(dat_6_10$R, main = "Xbar chart", type = "b",ylim = c(0,0.15),ylab = "Mean",xlab = "Rational Group")
plot(dat_6_10$R, main = "Xbar chart", type = "b",ylim = c(0,0.3),ylab = "Mean",xlab = "Rational Group")
plot(dat_6_10$R, main = "Xbar chart", type = "b",ylim = c(0,0.25),ylab = "Mean",xlab = "Rational Group")
CL_R = mean(dat_6_10$R)
UCL_R = D4_3 * CL_R
plot(dat_6_10$R, main = "Xbar chart", type = "b",ylim = c(0,0.25),ylab = "Mean",xlab = "Rational Group")
abline(h = 0,lty= 2)
abline(h = UCL_R, lty = 2)
abline(h = CL_R)
CL_S = mean(dat_6_10$S)
UCL_R = B4_3 * CL_S
plot(dat_6_10$R, main = "S chart", type = "b",ylim = c(0,0.25),ylab = "S",xlab = "Rational Group")
abline(h = 0,lty= 2)
abline(h = UCL_R, lty = 2)
abline(h = CL_R)
CL_S = mean(dat_6_10$S)
UCL_R = B4_3 * CL_S
plot(dat_6_10$R, main = "S chart", type = "b",ylim = c(0,0.25),ylab = "S",xlab = "Rational Group")
abline(h = 0,lty= 2)
abline(h = UCL_R, lty = 2)
abline(h = CL_S)
CL_S = mean(dat_6_10$S)
UCL_R = B4_3 * CL_S
plot(dat_6_10$S, main = "S chart", type = "b",ylim = c(0,0.25),ylab = "S",xlab = "Rational Group")
abline(h = 0,lty= 2)
abline(h = UCL_R, lty = 2)
abline(h = CL_S)
CL_S = mean(dat_6_10$S)
UCL_R = B4_3 * CL_S
plot(dat_6_10$S, main = "S chart", type = "b",ylim = c(0,0.15),ylab = "S",xlab = "Rational Group")
abline(h = 0,lty= 2)
abline(h = UCL_R, lty = 2)
abline(h = CL_S)
CL_S = mean(dat_6_10$S)
UCL_R = B4_3 * CL_S
plot(dat_6_10$S, main = "S chart", type = "b",ylim = c(0,0.12),ylab = "S",xlab = "Rational Group")
abline(h = 0,lty= 2)
abline(h = UCL_R, lty = 2)
abline(h = CL_S)
CL_S = mean(dat_6_10$S)
UCL_R = B4_3 * CL_S
plot(dat_6_10$S, main = "S chart", type = "b",ylim = c(0,0.13),ylab = "S",xlab = "Rational Group")
abline(h = 0,lty= 2)
abline(h = UCL_R, lty = 2)
abline(h = CL_S)
allX <-c(X1,X2,X3)
allX <-c(dat_6_10$X1,dat_6_10$X2,dat_6_10$X3)
qqplot(allX)
allX <-c(dat_6_10$X1,dat_6_10$X2,dat_6_10$X3)
qqnorm(allX)
piston2 = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data_Phase_II.csv")
piston2 = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data_Phase_II.csv")
# plot phase II xbar chart
plot(piston2$Xbar, type="b", ylim=c(73.985, 74.015),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart (Phase II)")
piston2 = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data_Phase_II.csv")
# plot phase II xbar chart
plot(piston2$Xbar, type="b", ylim=c(73.985, 80),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart (Phase II)")
piston2 = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data_Phase_II.csv")
# plot phase II xbar chart
plot(piston2$Xbar, type="b", ylim=c(73.985, 75),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart (Phase II)")
plot(piston2$Xbar, type="b", ylim=c(73.985, 74.1),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart (Phase II)")
plot(piston2$Xbar, type="b", ylim=c(73.985, 74.04),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart (Phase II)")
plot(piston2$Xbar, type="b", ylim=c(73.985, 74.03),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart (Phase II)")
abline(h = LCLx, lty=2)
piston = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data.csv")
Xbarbar = mean(piston$Xbar)
Rbar = mean(piston$R)
LCLx = Xbarbar - Rbar * A2_5
UCLx = Xbarbar + Rbar * A2_5
A2_5 = 0.577
A2_8 = 0.373
d2_8 = 2.847
d2_5 = 2.326
D4_5 = 2.114
D3_5 = 0
D4_8 = 1.864
D3_8 = 0.136
B4_5 = 2.089
B3_5 = 0
#new data
xBar = xBar[c(-12,-15)]
R = R[c(-12,-15)]
xBarBar = mean(xBar)
RBar = mean(R)
#xbar chart
UCLx = xBarBar + A2 * RBar
LCLx = xBarBar - A2 * RBar
plot(xBar, main = "Xbar chart", ylim = c(30,40),type = "b",ylab = "Mean",xlab = "Rational Group")
abline(h = LCLx,lty = 2)
abline(h = UCLx, lty = 2)
abline(h = xBarBar)
#R chart
UCLR = D4 * RBar
LCLR = D3 * RBar
plot(R,ylab="Range", xlab="Rational group",type = "b",ylim = c(0,10),main="R chart")
abline(h = UCLR, lty=2)
abline(h = LCLR, lty=2)
abline(h = RBar)
A2_5 = 0.577
A2_8 = 0.373
d2_8 = 2.847
d2_5 = 2.326
D4_5 = 2.114
D3_5 = 0
D4_8 = 1.864
D3_8 = 0.136
B4_5 = 2.089
B3_5 = 0
# load the data
piston = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data.csv")
Xbarbar = mean(piston$Xbar)
Rbar = mean(piston$R)
#xbar chart
LCLx = Xbarbar - Rbar * A2_5
UCLx = Xbarbar + Rbar * A2_5
# plot xbar chart
plot(piston$Xbar, type="b", ylim=c(73.985, 74.015),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart")
abline(h = LCLx, lty=2)
abline(h = UCLx, lty=2)
abline(h = Xbarbar)
#R chart
UCLR = D4_5 * Rbar
LCLR = D3_5 * Rbar
plot(piston$R, type="b", ylim=c(0, 0.05),ylab="Range of piston diameter", xlab="Rational group",main="Shewhart R chart")
abline(h = UCLR, lty=2)
abline(h = LCLR, lty=2)
abline(h = Rbar)
#schart
sbar = mean(piston$S)
UCLS = B4_5 * sbar
LCLS = B3_5 * sbar
plot(piston$S, type="b", ylim=c(0, 0.02),
ylab="SD of piston diameter", xlab="Rational group",
main="Shewhart R chart")
abline(h = UCLS, lty=2)
abline(h = LCLS, lty=2)
abline(h = sbar)
piston2 = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data_Phase_II.csv")
piston2 = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data_Phase_II.csv")
# plot phase II xbar chart
plot(piston2$Xbar, type="b", ylim=c(73.985, 74.03),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart (Phase II)")
abline(h = LCLx, lty=2)
abline(h = UCLx, lty=2)
abline(h = Xbarbar)
piston2 = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data_Phase_II.csv")
# plot phase II xbar chart
plot(piston2$Xbar, type="b", ylim=c(73.985, 74.03),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart (Phase II)")
abline(h = LCLx, lty=2)
abline(h = UCLx, lty=2)
abline(h = Xbarbar)
# plot phase II R chart
plot(piston2$R, type="b", ylim=c(0, 0.05),
ylab="Range of piston diameter", xlab="Rational group",
main="Shewhart R chart (Phase II)") abline(h = LCLR, lty=2)
abline(h = UCLR, lty=2)
abline(h = Rbar)
# plot phase II s chart
plot(piston2$S, type="b", ylim=c(0, 0.02),
ylab="SD of piston diameter", xlab="Rational group",
main="Shewhart S chart (Phase II)") abline(h = LCLS, lty=2)
abline(h = UCLS)
abline(h = sbar)
plot(piston2$Xbar, type="b", ylim=c(73.985, 74.03),ylab="Mean piston diameter", xlab="Rational group",main="Shewhart Xbar chart (Phase II)")
abline(h = LCLx, lty=2)
abline(h = UCLx, lty=2)
abline(h = Xbarbar)
plot(piston2$R, type="b", ylim=c(0, 0.05),
ylab="Range of piston diameter", xlab="Rational group",
main="Shewhart R chart (Phase II)")
abline(h = LCLR, lty=2)
abline(h = UCLR, lty=2)
abline(h = Rbar)
plot(piston2$S, type="b", ylim=c(0, 0.02),
ylab="SD of piston diameter", xlab="Rational group",
main="Shewhart S chart (Phase II)")
abline(h = LCLS, lty=2)
abline(h = UCLS)
abline(h = sbar)
R = c(3,4,4,4,5,6,4,3,7,8,3,9,8,6,5,7,4,3,8,4,2,1,3,2)
R/d2_5
mean(R)/d2_5
R
34.5/0.00345
a R/10000
a = R/10000
mean(a)
mean(a)/d2_5
xBar = c(34.5,34.2,31.6,31.5,35,34.1,32.6,33.8,34.8,33.6,31.9,38.6,35.4,34,37.1,34.9,33.5,31.7,34,35.1,33.7,32.8,33.5,34.2)
R = c(3,4,4,4,5,6,4,3,7,8,3,9,8,6,5,7,4,3,8,4,2,1,3,2)
xBarBar = mean(xBar)
RBar = mean(R)
xBarBar
(0.5020 - 0.50340)/0.0002
(0.5040-0.5034)/0.0002)
(0.5040-0.5034)/0.0002
pnorm(3) - pnorm(-7)
1 - 0.9986501
A2_5 = 0.577
A2_8 = 0.373
d2_8 = 2.847
d2_5 = 2.326
D4_5 = 2.114
D3_5 = 0
D4_8 = 1.864
D3_8 = 0.136
B4_5 = 2.089
B3_5 = 0
# load the data
piston = read.csv("http://stat.umn.edu/hawkins/5031/Piston_data.csv")
Xbarbar = mean(piston$Xbar)
Rbar = mean(piston$R)
Xbarbar
piston
xBarBar
xbarbar
Xbarbar
Xbarbar/d2_5
Rbar/d2_5
0.5/0.01
pnorm(50)
pnorm(-50)
pnorm(-3)
pnorm(-3)
qnorm(0,9)
qnorm(0.9)
3-1.28
pnorm(3)
qnorm(0.001,7.4,3.12)
qnorm(0.001,7.4,2.87)
qnorm(0.001,6.82,2.87)
?qnorm
qnorm(0.999,6.82,2.87)
data = read.csv("yelpdata.txt")
setwd("~/Desktop/UMN/STAT4986W/Final Project/DataCleaning")
data = read.csv("yelpdata.txt")
len(data)
length(data)
summary(dat)
summary(data)
